---
title: "FTZ Write-Up"
tags: [pwnable, ftz]
categories: [pwnable]
---

# Index

> 1. [Level 1](#level-1)
2. [Level 2](#level-2)
3. [Level 3](#level-3)
4. [Level 4](#level-4)
5. [Level 5](#level-5)



## Level 1

가장 첫 번째 문제의 경우 level1:level1 계정으로 ssh를 통해 로그인할 수 있었습니다. hint 파일의 내용을 확인한 결과 level2 권한을 가진 setuid가 설정된 파일을 찾으라고 하였기에 아래와 같은 명령을 사용하였습니다.

```
find / -perm -4000 -user level2 2>/dev/null
```

위 명령어를 실행한 결과 /bin/ExecuteMe 파일을 실행하여 level2 권한으로 명령어를 실행할 수 있다는 것을 알 수 있었습니다.

허나 비밀번호를 알 수 있는 `my-pass` 명령어는 직접적으로 사용할 수 없었기 때문에 다른 방법을 찾아야 했습니다. 처음 생각한 방법은 script를 사용하여 my-pass라는 명령을 간접적으로 사용하려고 하였으나, home directory에 write 권한이 없었기에 실패하였습니다.

이에 해당 파일을 통해 알아내는 방법이 아닌 다른 방법을 생각한 결과 bash 명령어를 사용하여 bash shell을 실행할 수 있는 것을 알게 되었습니다. 결과적으로 level2로 로그인 된 bash shell을 통해 계정의 password를 알 수 있었습니다.

## Level 2

Level 2의 hint를 확인해보면 "텍스트 파일을 편집하는 중 쉘의 명령을 실행할 수 있다." 라고 되어있는 것을 확인할 수 있었습니다. 이미 overthewire 페이지에서 이와 유사한 문제를 풀었던 적이 있었기에 vi 에디터에서 shell이 실행 가능한 방법을 알고 있었고 아무런 파일이나 open하여 shell을 실행시켜 보았습니다.

그러나 level3의 비밀번호를 알기 위해서는 level3의 setuid가 설정된 파일을 필요로 하였는데 먼저 home directory를 살펴본 결과 해당되는 파일을 찾을 수 없었기에 level1에서 사용하였던 방법과 같이 찾아본 결과 /usr/bin/editor 파일이 해당되는 것을 확인할 수 있었습니다.

따라서 해당 파일을 실행한 후 vi 에디터에서 다음과 같이 진행하였습니다.

```
:set shell=/bin/bash
:shell
```

이후 level3로 로그인 된 shell을 획득할 수 있었고 비밀번호를 알아낼 수 있었습니다.

## Level 3

Level 3의 경우 hint에서 프로그램에 대한 code 설명을 확인할 수 있었습니다. code에 대해 간략하게 요약하면 host 정보를 입력받아 자동으로 dig 명령을 실행해주는 프로그램이었습니다.

또한 추가 힌트로 동시에 여러 개의 명령어를 실행하는 것과 명령어를 문자열 형태로 전달하는 법에 대한 내용이 있었는데 이를 통해 아래와 같이 명령어를 작성할 수 있었습니다.

```
autodig "localhost || my-pass"
```

autodig 프로그램은 level4의 권한으로 실행되었기에 위와같이 실행하여 level4의 password를 얻을 수 있었습니다.

## Level 4

Level 4 hint의 경우 /etc/xinted.d에 backdoor가 심어져 있다고 하였습니다. 해당 directory를 확인해 본 결과 backdoor라는 파일을 확인할 수 있었습니다.

xinted.d directory의 역할에 대해 먼저 알아본 결과 "**super daemon**"에 관한 directory라는 것을 확인할 수 있었으며 어느정도 파일의 구조에 대해서도 확인할 수 있었습니다.

backdoor file의 내용을 확인해 본 결과 service명이 finger로 등록되어 있으며 실행 시 /home/level4/tmp/backdoor라는 파일을 실행하는 것으로 파악되었습니다. 그러나 해당 경로를 확인한 결과 backdoor라는 파일을 찾을 수 없었는데 이는 곧 해당 파일을 작성해야 한다고 생각되어 방법을 생각해 보았습니다.

위 내용까지는 접근을 하였으나 그 이후에 backdoor를 실행할 수 있는 방법에 대해 감을 잡지 못하여 [링크](https://nextline.tistory.com/56)를 참조하여 문제를 해결하였습니다. super daemon 구성에 대한 이해도가 더 필요했던 것 같습니다.

## Level 5


