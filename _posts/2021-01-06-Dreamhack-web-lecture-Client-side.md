---
title: "Dreamhack Web hacking Lecture(Client-Side)"
tags: ["basic theory", client-side, "dreamhack lecture"]
categories: ["Web"]
---

## Client-Side Basic

Dreamhack의 web hacking 강의 중 Client-side basic 강의를 보며 이해한 내용을 기반으로 작성하였습니다.

* * *

## **SOP**

**Same Origin Policy**의 약자로 Javascript 또는 HTML tag를 사용하여 외부 리소스를 불러오는 기능을 이용, 기존에 정의되지 않은 악의적인 행위를 할 수 있는데 이를 방지하기 위한 정책으로 만들어졌습니다.

이 정책은 서로 다른 Origin의 문서 또는 스크립트 간의 상호 작용을 제한함으로서 목적을 달성합니다. 여기서 Origin은 URL의 scheme, host, port를 통해 정의됩니다. 즉, 다른 origin이라고 함은 다른 URL을 의미합니다.

SOP의 경우 대체로 다른 Origin으로 정보를 송신하는 것은 허용되나 다른 Origin으로부터 정보를 수신받는 것은 허용되지 않는다고 합니다. 이는 결국 CSRF 공격에 악용될 수 있다는 단점이 있지만 정보의 송신을 금지할 경우 hyperlink를 사용할 수 없기에 정상적인 구현이 힘들게 됩니다.

* * *

## **CORS**

**Cross Origin Resource Sharing**의 약자로 추가 HTTP Header를 사용하여 한 Origin에서 사용 중인 웹 애플리케이션이 다른 Origin의 선택 자원에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제입니다.

이는 SOP의 영향으로 인해 서로 다른 Origin과 Resource를 공유할 수 없는 것을 해결하기 위함으로 개발 또는 운영 목적으로 이를 필요로 하는 상황이 있을 수도 있기에 SOP가 적용된 상태에서도 리소스를 공유할 수 있는 방법이 CORS라고 합니다.

CORS를 구성하는 방법의 경우 **postMessage**, **JSONP**, **CORS Header 사용** 세 가지가 있습니다.

```
- postMessage
메시지를 주고받기 위한 이벤트 핸들러를 이용하여 리소스를 공유

- JSONP
스크립트 태그를 통해 다른 Origin의 Resource를 요청하고, 응답 데이터를 현재 Origin의 Callback 함수에서 다루는 방식으로 리소스를 공유

- CORS Header 사용
다른 Origin이 허용하는 설정 등을 HTTP Header를 통해 확인한 후 허용하는 요청을 보내 리소스를 공유하는 방식
```

* * *

## **XSS**

**Cross Site Scripting**의 약자로 서버의 응답에 공격자가 삽입한 악성 스크립트가 포함되어 사용자의 웹 브라우저에서 해당 스크립트가 실행되는 취약점을 의미합니다.

주로 사용자의 세션 혹은 쿠키를 탈취하여 권한을 획득하거나 페이지를 변조하는 등의 공격을 수행할 수 있으며 성공적으로 수행하기 위해서는 아래 두 가지 조건을 만족해야 합니다.

```
- 입력 데이터에 대한 충분한 검증 과정이 없을 것
 : 악성 스크립트 삽입을 위해서는 입력 데이터에 대한 검증의 허점이 필요합니다.

- 서버의 응답 데이터가 웹 브라우저 내 페이지에 출력 시 충분한 검증 과정이 없을 것
 : 이 또한 위와 마찬가지로 악성 스크립트가 웹 브라우저 렌더링에 성공하기 위해서는 검증의 허점이 필요합니다.
```

* * *

xss는 웹 서비스에 있어서 빈번하게 발생하는 취약점인 만큼 그에 대응하기 위한 다양한 기술 또한 있습니다. 아래는 그 기술들의 예시 중 하나입니다.

- Server-side Mitigations
- HTTPOnly flag 사용
- Content Security Policy 사용
- X-XSS-Protection

* * *

## **CSRF**

**Cross Site Request Forgery**의 약자로 사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위를 특정 웹 사이트에 요청하도록 하는 웹 애플리케이션 취약점을 의미합니다.

CSRF의 경우 공격자가 사용자의 컴퓨터를 감염 시키거나 대상 서버를 직접적으로 해킹하여 실행되는 것이 아니기에 성공을 위한 조건이 필요합니다.

```
- 해당 웹 사이트가 쿠키를 이용한 인증 방식을 사용할 것
 : 모든 HTTP 전송은 쿠키값 또한 같이 전송되기에 쿠키에 저장된 Session id도 전송되기 때문입니다.

- 사용자가 로그인 되어 있는 상태여야 할 것
 : CSRF 공격의 핵심은 서버 측에서 신뢰할 수 있는 사용자로 인식하도록 하여 공격을 수행하기 때문입니다.

- 공격자가 사전에 알 수 없는 파라미터가 존재하지 않을 것
 : 자동입력 방지와 같은 기능이 있을 경우 공격에 성공할 수 없습니다.

- 사용자가 피싱 사이트 혹은 메일, 게시글과 같이 CSRF script가 작성되어 있는 게시물을 접속할 것
 : 계정 정보를 얻어내기 위해 가장 선행되는 작업이기도 합니다.
```

* * *

이와 같은 CSRF 공격을 예방하기 위해서 보통 다음과 같은 두 가지 방법을 사용한다고 합니다.

- Session Cookie 대신 Custom Header를 통한 사용자 인증
- 공격자가 예측할 수 없는 파라미터 사용
	- CAPTCHA
	- CSRF Token

* * *

## **Open Redirect**

**Open Redirect**의 경우 다른 페이지로 이동하기 위해 사용되는 Redirect를 공격자가 변조함으로써 이를 악용하는 취약점을 의미합니다.

Open Redirect의 경우 이동되는 페이지를 피싱 사이트로 설정하여 추가적인 정보를 얻어내거나 다른 취약점을 연계하는데 사용할 수도 있습니다.

* * *

이러한 취약점을 예방하기 위해서는 다음과 같은 방법을 사용할 수 있습니다.

- White List를 이용한 필터링
 : Redirect에 사용할 링크를 White List로 구성하여 다른 주소에 대한 간섭을 방지할 수 있습니다.
- 외부 링크로 이동할 경우 경고창 출력
 : 사용자에게 직접적으로 경고를 보여줌과 동시에 혹시 모를 위험성에 대해 상기시켜 줄 수 있다.

* * *

## **Click Jacking**

**Click Jacking**의 경우 웹 브라우저 화면에 출력되는 내용에 html, css, javascript와 같이 화면 출력에 영향을 주는 요소를 이용하여 눈속임을 통해 사용자의 클릭을 유도하는 공격 방법입니다.

사용자의 클릭을 유도하는 페이지를 생성 후 이를 css 설정에서 투명도를 0으로 바꿔 보이지 않게 만들거나 하여 공격을 수행합니다.

* * *

Click Jacking을 예방하기 위해서는 두 가지 방법을 사용할 수 있습니다. 두 방법 모두 부모 페이지의 URL을 제한하여 예방한다는 공통점이 있습니다.

- X-Frame-Options
- frame-ancestors
